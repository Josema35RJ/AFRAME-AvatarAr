<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Avatar AR Profesional</title>
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
</head>
<body style="margin:0; overflow:hidden;">

  <!-- Escena AR con WebXR -->
  <a-scene
    vr-mode-ui="enabled: false"
    embedded
    renderer="colorManagement: true; physicallyCorrectLights: true"
    webxr="requiredFeatures: hit-test; optionalFeatures: dom-overlay,local-floor; overlayElement: #overlay">

    <!-- Assets -->
    <a-assets>
      <a-asset-item id="avatarModel" src="https://cdn.jsdelivr.net/gh/Josema35RJ/Avatar@main/3dpea.com_Salute.glb"></a-asset-item>
    </a-assets>

    <!-- Avatar (se coloca con script) -->
    <a-entity id="avatar"
              gltf-model="#avatarModel"
              scale="0.5 0.5 0.5"
              visible="false">
    </a-entity>

    <!-- Luces -->
    <a-entity light="type: ambient; intensity: 1"></a-entity>
    <a-entity light="type: directional; intensity: 0.8" position="0 4 4"></a-entity>

    <!-- C√°mara -->
    <a-entity id="camera" camera look-controls></a-entity>
  </a-scene>

  <!-- Interfaz de botones -->
  <div id="overlay" style="position:absolute; bottom:20px; width:100%; text-align:center; z-index:999;">
    <button onclick="colocarAvatar()" style="padding:10px 20px; margin:5px; font-size:16px;">üìç Colocar Avatar</button>
    <button onclick="resetAvatar()" style="padding:10px 20px; margin:5px; font-size:16px;">üîÑ Reset</button>
  </div>

  <script>
    const avatar = document.getElementById("avatar");
    const camera = document.getElementById("camera");

    // Colocar avatar en frente de la c√°mara
    function colocarAvatar() {
      const camPos = camera.object3D.position;
      const camDir = new THREE.Vector3();
      camera.object3D.getWorldDirection(camDir);

      // Distancia fija al frente (2 metros)
      const distance = 2.0;
      const newPos = camPos.clone().add(camDir.multiplyScalar(distance));

      avatar.setAttribute("position", `${newPos.x} ${newPos.y - 1.5} ${newPos.z}`);
      avatar.object3D.lookAt(camPos); // Que mire hacia el usuario
      avatar.setAttribute("visible", "true");
    }

    // Resetear avatar
    function resetAvatar() {
      avatar.setAttribute("visible", "false");
    }
  </script>
</body>
</html>
